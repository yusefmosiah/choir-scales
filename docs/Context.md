# Choir Project Context

## Overview

Choir is an innovative socioeconomic media network that leverages blockchain technology to redefine content creation, curation, and collaboration. The platform aims to create the world's highest signal human dataset, which will serve as the foundation for training AI models that excel in both technical prowess and qualitative, stylistic, and artistic dimensions.

## Current State

### Core Components

1. **Chorus AI System**

   - Implemented in `chorus.py`
   - Uses a multi-step process: Action, Experience, Intention, Observation, Update, and Yield
   - Integrates with a vector database (Qdrant) for semantic search

2. **Frontend Components**

   - React-based components for user interaction
   - Key components include:
     - StreamChat
     - ChorusStep
     - ChorusPanel
     - SourcesList
     - UserInput
     - AIResponse

3. **Blockchain Integration**

   - Solana wallet integration (functional)
   - Components for wallet connection and transactions (SignMessage, SendTransaction)

4. **User Interface**
   - Dark-themed interface with a chat-like layout
   - Responsive design using Tailwind CSS
   - Main components:
     - Left sidebar with chat thread tabs
     - Chat window for user-AI interaction
     - Chorus Panel displaying AI steps and sources
     - User input area with submit button
   - Planned enhancements:
     - Separate interfaces for signed-in and signed-out users
     - Dashboard for signed-in users
     - Autogenerated chat thread names
     - Integration of Authors Chat within chat threads
     - Improved accessibility features

### Database and Configuration

- Qdrant vector database integration for storing and retrieving content
- Configuration management using environment variables and Pydantic
- Utility functions for embeddings and chat completions using Azure OpenAI

### Tokenomics

- CHOIR token defined with a total supply of 10 billion
- Token distribution mechanisms outlined in the whitepaper
- Implementation still in planning phase

### AI Model

- Target date for the first AI model release: April 27, 2025
- Plan to use Reinforcement Learning with the token-scored dataset

## Development Status

- **Solana Wallet Integration**: Functional, inherited from Solana dApp Scaffold
- **Qdrant Integration**: Implemented for data storage and retrieval
- **UI/UX**: Basic implementation complete, based on the provided image
- **Chorus AI**:
  - Implemented with multi-step process: Action, Experience, Intention, Observation, Update, and Yield
  - Integrated with Qdrant for semantic search
  - Planned enhancements include merging `final_response` and `yield` steps, and including inline citations
- **CHOIR Token**:
  - Token defined with a total supply of 10 billion
  - Minting functionality implemented
  - Reward system in place for content creation and citations
  - Token usage for edit requests implemented
- **Authors Chat**: In planning phase
- **Email Notifications**: In planning phase
- **Tokenomics Implementation**: Basic functionality in place, further enhancements planned
- **Testing**:
  - Currently, the project lacks comprehensive testing
  - Plans are in place to implement:
    - Unit and integration tests for Python and TypeScript components
    - Fuzz testing for Solana programs using Ackee Trident
  - Implementation of testing is deferred until after the MVP launch to prioritize core feature development during the sprint

## Next Steps

The immediate next steps, as outlined in the blueprint, focus on:

1. Enhancing Solana Wallet Authentication
2. Further integrating Qdrant for Data Storage
3. Enhancing the Chorus AI System
4. Redesigning the User Interface and Enhancing UX
   - Implement chat thread tabs in left sidebar
   - Create separate interfaces for signed-in and signed-out users
   - Develop a dashboard for signed-in users
   - Integrate Authors Chat within chat threads
   - Improve accessibility
5. Implementing Authors Chat Functionality
6. Preparing for Tokenomics Integration
7. Developing and Deploying Solana Programs (Smart Contracts)
8. Implementing an Email Notification System
9. Integrating Thirdweb Embedded Wallet
10. Producing Media Assets and Publishing Documentation
11. Deploying, Testing, and Launching MVP

These steps are part of a 7-day sprint to reach the MVP by October 17, 2024.

## Solana Wallet Integration

The Choir project utilizes the Solana Wallet Adapter for seamless integration with Solana wallets. Here's how it's implemented in the codebase:

1. **Setup**:
   - The wallet adapter is set up in `ContextProvider.tsx`.
   - It uses `ConnectionProvider` and `WalletProvider` from `@solana/wallet-adapter-react`.

2. **Wallet Connection**:
   - The `useWallet` hook from `@solana/wallet-adapter-react` is used to access wallet functions.
   - `useConnection` hook provides access to the Solana network connection.

3. **Transaction Handling**:
   - Transactions are created using `@solana/web3.js` library.
   - The wallet's `sendTransaction` method is used to sign and send transactions.

4. **UI Components**:
   - `WalletMultiButton` from `@solana/wallet-adapter-react-ui` is used for wallet connection UI.

5. **Custom Components**:
   - `SendTransaction.tsx` and `SendVersionedTransaction.tsx` demonstrate how to create and send transactions.
   - `SignMessage.tsx` shows how to sign messages using the connected wallet.

6. **State Management**:
   - Wallet connection state is managed by the wallet adapter context.
   - Custom hooks like `useUserSOLBalanceStore` interact with the wallet to fetch balances.

This integration allows for a unified interface to connect various Solana wallets and interact with the Solana blockchain, providing a seamless experience for users to authenticate and perform blockchain operations within the Choir application.

## Testing Strategy

While testing is deferred for the initial MVP sprint, the project has a clear strategy for implementing robust testing post-launch:

1. **Unit and Integration Tests**:
   - For Python backend components
   - For TypeScript frontend components
   - These will cover core functionalities and edge cases

2. **Solana Program Testing**:
   - Utilize Ackee Trident for fuzz testing of Solana smart contracts
   - Trident provides automated techniques to generate random, invalid, or unexpected input data, helping to discover unknown bugs and vulnerabilities [source](https://ackee.xyz/trident/docs/latest/)

3. **Trident Fuzz Testing Features**:
   - Automatically parses Anchor-based programs
   - Generates templates for customized fuzz test scenarios
   - Offers derive macros to implement required traits
   - Includes a bank client and helper functions for account management during testing
   - Provides a CLI for executing and debugging fuzz tests

4. **Fuzz Testing Capabilities**:
   - Test different execution orders of instructions
   - Explore variations in instruction parameters
   - Examine the impact of different account states
   - Conduct comprehensive testing by combining multiple aspects

The decision to defer testing until after the MVP launch phase allows the team to focus on rapid development and feature implementation during the initial sprint. This approach aims to balance the need for a quick MVP release with the long-term goal of ensuring robust and secure code.
